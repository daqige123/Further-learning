#### DNS解析过程总结：

我们在浏览器中输入域名后，比如 www.qq.com.cn

1.  浏览器自身的DNS缓存  ==》操作系统的host文件  ==》 本地DNS服务器

2. 本地DNS服务器如果还没有记录的话，那就会去他的上一级域名服务器就是 qq.com.cn找记录，如果有就让他返回对应的ip, 没有就再向上一级查询就是.comc.n服务器查询，如果还没有，那就.cn,就这样递归查询到跟服务器。根服务器是肯定能告诉你.com的ip的，然后.com又会告诉你qq.com.cn的地址, 然后就是递归回来。









## DNS 缓存

### 什么是DNS

全称 Domain Name System ,即域名系统。

> 万维网上作为域名和IP地址相互映射的一个分布式数据库，能够使用户更方便的访问互联网，而不用去记住能够被机器直接读取的IP数串。DNS协议运行在UDP协议之上，使用端口号53。

### DNS解析

简单的说,通过域名,最终得到该域名对应的IP地址的过程叫做域名解析（或主机名解析）。

```
www.dnscache.com (域名) - DNS解析 -> 11.222.33.444 (IP地址)
```

### DNS缓存

有dns的地方,就有缓存。浏览器、操作系统、Local DNS、根域名服务器，它们都会对DNS结果做一定程度的缓存。

DNS查询过程如下:

1. 首先搜索浏览器自身的DNS缓存,如果存在，则域名解析到此完成。
2. 如果浏览器自身的缓存里面没有找到对应的条目，那么会尝试读取操作系统的hosts文件看是否存在对应的映射关系,如果存在，则域名解析到此完成。
3. 如果本地hosts文件不存在映射关系，则查找本地DNS服务器(ISP服务器,或者自己手动设置的DNS服务器),如果存在,域名到此解析完成。
4. 如果本地DNS服务器还没找到的话,它就会向根服务器发出请求,进行递归查询。



