## 应用层

### HTTP

##### HTTP请求和响应报文的组成：

请求行 + 请求首部 + 请求主体

##### 1. 起始行

请求行 ：请求方式 + 请求URL（请求URL描述了要对哪个资源执行这个方法） + 协议名称以及版本。

响应行：协议名称版本+ 状态码 说明出现了什么情况。

##### 2.首部

不是重点，大概知道就行了。

首部可以在客户端、服务器和其他应用程序之间提供一些非常有用的通用功能。比如Date,Accept。

##### 3. 请求主体

空行之后就是可选的报文主体了，其中包含了所有类型的数据。请求主体中包括了要发送给Web 服务器的数据；响应主体中装载了要返回给客户端的数据。起始行和首部都是文本形式且都是结构化的，而主体则不同，主体中可以包含任意的二进制数据（比如图片、视频、音轨、软件程序）。当然，主体中也可以包含文本。

#### HTTP 状态码

http返回的响应报文中第一行就包含了状态码。

1XX  表示请求正在处理中。100 请继续发送  101切换协议  

2XX 表示请求成功处理。

3XX 重定向   301永久性重定向  302临时重定向  304 请求报文首部包含的条件不满足是返回

\1. 301 Moved Permanently ：永久性重定向；

\2. 302 Found ：临时性重定向；

\3. 303 See Other ：和 302 有着相同的功能，但是 303 明确要求客户端应该采用 GET 方法获取资源。

4XX  客户端错误 400请求报文错误   401发送的请求需要认证信息。 403请求被拒绝，404 not found

5XX  500服务器出现错误  503 服务器暂时处于超负载或停机。

#### HTTP方法

##### GET  获取资源  

##### POST 通过常用于向服务器提交数据，比如表单提交常常用到post

##### HEAD 只从服务器获取文档的首部。这就允许客户端在未获取实际资源的情况下，对资源的首部进行检查。

##### PUT   上传文件，将请求的主体部分存储在服务器上，由于自身不带验证机制，任何人都可以上传文          件，不安全。

##### delete 从服务器上删除一份文档。

#### GET 和 POST的区别

1. 从功能上讲，get 是用来从服务器上获取资源的，而POST是用来向服务器提交数据的。
2. 从请求参数上看，GET请求的数据会附在URL之后，就是url后面接一个问号，然后参数之间以&相连。而post会把提交的数据放置在报文的主体中。
3. 安全性方面，POST的数据是包装在报文的主体中的，而GET是明文接在URL后面的，所以POST更安全。
4. GET请求的长度受限于浏览器的输入的字符串大小只能是2KB左右，而post没有大小限制。

#### DNS的解析过程

我们在浏览器中输入域名后，比如 123.abc.qq.com.cn

1. 浏览器会先看自身有没有这个域名的缓存，有就直接返回，没有的话，就去查看host文件，如果没有就回去问本地域名服务器。

2. 本地域名服务器如果没有域名的记录的话，就会去看看有没有abc.qq.com的记录，如果有就去找它要答案，如果没有找有没有qq.com.cn的记录，在没有就去找.com.cn。就这样一直问到根服务器。然后再根据根服务器的记录，再一级一级的找回去。

#### HTTP的长连接和短连接，和应用场景。

1. HTTP1.0协议就是默认用的短连接。短连接就是客服端和服务端每申请一个资源，就建立一次连接。比如一个页面里面有js、css、静态图片等资源，需要重新建立一个http会话。
2. HTTP1.1开始就是用长链接了。长连接就是，当CS建立起连接后，在一定时间内不会断开，我们可以继续用这个这个连接请求其他资源，这样就节省了再次建立TCP连接的开销。

#### HTTP1.0, HTTP1.1 HTTP2.0的区别

##### http1.1

1. http1.1首先是提出了长连接，可以在一次连接中不断发送请求，避免了多次建立TCP链接的开销。
2. HTTP1.1 支持只发送 header 而不发送 body。原因是先用 header 判断能否成功，再发数据，节约带宽。

3. TTP1.1 的 host 字段。由于虚拟主机可以支持多个域名，所以一般将域名解析后得到 host。

##### HTTP2.0

1. HTTP/2 采用二进制格式传输数据，而非 HTTP 1.x 的文本格式，二进制协议解析起来更高效。

1. HTTP2.0支持多路复用，同一个连接可以并发处理多个请求，方法是把 HTTP数据包拆为多个帧，并发有序的发送，根据序号在另一端进行重组，而不需要一个个 HTTP请求顺序到达；

2. HTTP2.0 支持服务端推送，就是服务端在 HTTP 请求到达后，除了返回数据之外，还推送了额外的内容给客户端；

3. HTTP2.0 适用于 HTTPS 场景，因为其在 HTTP和 TCP 中间加了一层 SSL 层。

#### HTTPS的工作流程

1. 客户端发送建立https连接的请求。

2. 服务器会向CA申请证书，然后发送证书给客服端。证书包括服务器信息，加密公钥，证书的颁发机构，过期时间等。
3. 客服端收到网站的证书后，验证其有效后，然后客服端随机生成一个随机值，用公钥加密发给服务器。

4. 服务器用私钥解析出消息，验证是否和浏览器的一致。
5. 如果计算出来的值和客服端发送的是一致的，则握手成功。



#### http和https的区别（对称加密，非对称加密，数字签名，数字证书，都必须懂！） 

>  1.安全性上。简单来说，HTTPS是使用TLS/SSL加密的HTTP协议。  
>  2.开销上，申请证书上，HTTPS需要使用ca申请证书 ，一般是要收费的。 
>  3.传输协议上, HTTP是超文本传输协议，明文传输；HTTPS是具有安全性的 SSL 加密传输协议，但是会消耗更多的资源。
>  4.连接方式与端口上，http的连接简单，是无状态的，端口是 80； https 在http的基础上使用了ssl协议进行加密传输，端口是 443

##### 对称加密、非对称加密

1. 对称密钥是指加密和解密都用同一个密匙，最大的问题是怎样将密匙安全地发送给接收方。
2.  非对称加密是指用公钥加密，我们可以顺便发公钥，因为只有用自己的私钥才能解密。

##### 什么是数字签名？

为了避免数据在传输过程中被替换，比如黑客修改了你的报文内容，但是你并不知道，所以我们让发送端做一个数字签名，把数据的摘要消息进行一个加密，比如 MD5，得到一个签名，和数据一起发送。然后接收端把数据摘要进行 MD5 加密，如果和签名一样，则说明数据确实是真的。

##### 数字证书

因为https里面使用的是对称加密，虽然数据签名可以保证数据不被替换，但是我们可以将公钥和数据直接全替换掉，客户端也不知道他们全是假的。所以为了保证发送方的公钥是真的，CA 证书机构会负责颁发一个证书,证书就保证里面的公钥保证是真的。

#### 在浏览器中输入 URL 地址到显示主页的过程？

\1. DNS 解析：浏览器查询 DNS，获取域名对应的 IP 地址：具体过程包括浏览器搜索自身的 DNS 缓存、搜索操作系统的 DNS 缓存、读取本地的 Host 文件和向本地 DNS 服务器进行查询等。对于向本地 DNS 服务器进行查询，如果要查询的域名包含在本地配置区域资源中，则返回解析结果给客户机，完成域名解析(此解析具有权威性)；如果要查询的域名不由本地 DNS 服务器区域解析，但该服务器已缓存了此网址映射关系，则调用这个 IP 地址映射，完成域名解析（此解析不具有权威性）。如果本地域名服务器并未缓存该网址映射关系，那么将根据其设置发起递归查询或者迭代查询；

\2. TCP 连接：浏览器获得域名对应的 IP 地址以后，浏览器向服务器请求建立链接，发起三次握手；

\3. 发送 HTTP 请求：TCP 连接建立起来后，浏览器向服务器发送 HTTP 请求；

\4. 服务器处理请求并返回 HTTP 报文：服务器接收到这个请求，并根据路径参数映射到特定的请求处理器进行处理，并将处理结果及相应的视图返回给浏览器；

\5. 浏览器解析渲染页面：浏览器解析并渲染视图，若遇到对 js 文件、css 文件及图片等静态资源的引用，则重复上述步骤并向服务器请求这些资源；浏览器根据其请求到的资源、数据渲染页面，最终向用户呈现一个完整的页面。

\6. 连接结束。

### 传输层

### TCP

##### 1.流量控制

主要是靠滑动窗口来实现流量控制的。流量控制就是说我们要控制发送方发送速率，保证接收方来得及接收。主要做法就是接受方发送确认报文中的窗口字段来控制发送方的发送窗口大小。

##### 2.拥塞控制

拥塞控制就是为了防止过多的数据一下子注入到网络中。流量控制，他考虑的是两个端到端之间的情况，而拥塞控制考虑的是整个网络数据的传输情况，就是包括路由器，所有主机他们的数据发送情况，是全局性的。拥塞控制就要求TCP发送方同时要维持一个拥塞窗口，这个窗口的大小取决于整个网络的拥塞情况，是动态变化的。所以最终的发送大小是取得流量控制里面的哪个发送窗口大小，和拥塞窗口里面的小的那一个值。

主要方法有：慢开始，拥塞避免，快重传、快开始。

